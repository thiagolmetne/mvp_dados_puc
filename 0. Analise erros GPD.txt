SELECT 
    gpd.Entity,
    case when gpd.GDP_percapta is null then 1 else 0 end as missing_gpd,
    gpd.year,
    COUNT(DISTINCT gpd.Entity) AS total_paises
FROM 
    basedosdados.mundo_kaggle_olimpiadas.microdados AS dados
GROUP BY 
    gpd.Entity,
    gpd.year